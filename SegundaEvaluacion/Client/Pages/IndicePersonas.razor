@page "/personas"
<h2>Personas</h2>
<br />
<a class="btn btn-primary" href="Personas/crear">Nuevo</a>
<br />
<table>
    <tr>
        <th>DNI</th>
        <th>Nombre</th>
        <th>Apellido</th>
        <th>Nacimiento</th>
        <th>Nacionalidad</th>
    </tr>
    @if (Personas == null)
    {
        <tr>Cargando.....</tr>
    }
    else if (Personas.Count == 0)
    {
        <tr>No existen Personas</tr>
    }
    else
    {
        @foreach (var item in Personas)
        {
<tr>
    <td>@item.dni</td>
    <td>@item.nombre</td>
    <td>@item.apellido</td>
    <td>@item.fecha_nacimiento</td>
    <td>@item.Nacionalidad</td>


    <td>
        <a class="btn btn-success"
           href="Personas/editar/@item.dni/@item.nombre/@item.apellido/@item.fecha_nacimiento/@item.Nacionalidad">
            Editar
        </a>
    </td>
    <td><button class="btn btn-warning" @onclick="()=>Eliminar(item)">Eliminar</button></td>
</tr>
        }
    }
</table>

<Confirmacion @ref="confirmacion"
              onConfirm="GrabarEliminar"
              onCancel="Cancelar"
              Titulo="BORRAR"
              textCancelar="Salir"
              textOk="Aceptar">
    <div>¿Desea eliminar a  @eliminarpersona.nombre @eliminarpersona.apellido ?</div>
</Confirmacion>


@code {
    List<SegundaEvaluacion.Shared.Datos.Entidades.Persona> Personas;
    Confirmacion confirmacion;
    string nompersona = "";
    string apepersona = "";
    SegundaEvaluacion.Shared.Datos.Entidades.Persona eliminarpersona;

    protected override void OnInitialized()
    {
        base.OnInitialized();

        Personas = new()
        {
            new SegundaEvaluacion.Shared.Datos.Entidades.Persona()
            {dni= 35987654, nombre = "Carla", apellido = "Alvarez", fecha_nacimiento = DateTime.Parse("01/01/1990")   }
        };
    }

    private void Eliminar(SegundaEvaluacion.Shared.Datos.Entidades.Persona personaEliminar)
    {
        confirmacion.Mostrar();
        nompersona = personaEliminar.nombre;
        apepersona = personaEliminar.apellido;
        eliminarpersona = personaEliminar;
    }


    private void GrabarEliminar()
    {
        Personas.Remove(eliminarpersona);
        Cancelar();
    }

    private void Cancelar()
    {
        confirmacion.Ocultar();
        eliminarpersona = null;
    }

}
